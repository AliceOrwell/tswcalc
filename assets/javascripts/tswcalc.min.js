/*! tswcalc 2013-05-29 */
function triggerReset(){$("#btn-reset").trigger("click")}function activateToolTips(){$(".glyph-tooltip, .signet-tooltip").tooltip({placement:"left"}),$(".cost-tooltip").tooltip({placement:function(t,e){var i=$(e).position();return 50>i.top?"bottom":"top"}}),$(".cost-tooltip, .glyph-tooltip, .signet-tooltip").on("click",function(t){t.preventDefault(),t.stopPropagation()})}function renderContainer(){dust.render("container",{slots:template_data.slots,signets:signet_data},function(t,e){t&&console.log(t),$(".container").html(e)})}function checkIfExported(){var t=$.getUrlVars();return!$.isEmptyObject(t)&&8==Object.keys(t).length||10==Object.keys(t).length?(importModule.start(t),!0):!1}function startSubModules(){for(var t=0;template_data.slots.length>t;t++)startDistributionButtonHandler(template_data.slots[t].id_prefix),startSelectHandler(template_data.slots[t]);startButtonBar(),startSummary(),startExportModule(),startImportModule()}function addHash(){""==location.hash&&(location.hash=" ")}function startDistributionButtonHandler(t){buttonHandler[t]=new DistributionButtonHandler(t),buttonHandler[t].initiate()}function startSelectHandler(t){selectHandler[t.id_prefix]=new SelectHandler(t),selectHandler[t.id_prefix].initiate()}function startButtonBar(){buttonBar=new ButtonBar,buttonBar.initiate()}function startSummary(){summary=new Summary}function startExportModule(){exportModule=new Export,exportModule.initiate()}function startImportModule(){importModule=new Import}function capitalise(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Summary(){self=this,this.updateAllStats=function(){self.updateCosts(),self.updatePrimaryStats(),self.updateOffensiveDefensiveStats()},this.collectAllStats=function(){return{primary:self.collectPrimaryStats(),offensive_defensive:self.collectOffensiveDefensiveStats()}},this.updateCosts=function(){for(var t=0,e=0,i=0,a=0;template_data.slots.length>a;a++){var n=selectHandler[template_data.slots[a].id_prefix].getQl(),r=selectHandler[template_data.slots[a].id_prefix].getGlyphQl();t+=bb_costs.glyph[r].cost,t+="weapon"==template_data.slots[a].group?bb_costs.weapon[n].cost:bb_costs.talisman[n].cost,"10.5"==n&&e++,"10.5"==r&&i++}$("#bb-cost").html(t),$("#cu-cost").html(e),$("#af-cost").html(i)},this.updatePrimaryStats=function(){var t=this.collectPrimaryStats();for(var e in t)t.hasOwnProperty(e)&&this.updateOnePrimaryStat(e,t[e]);this.updateCosts()},this.updateOnePrimaryStat=function(t,e){$("#stat-"+t).text(e)},this.collectPrimaryStats=function(){for(var t={"combat-power":0,"weapon-power":75,hitpoints:1970,"attack-rating":0,"heal-rating":0},e=0;template_data.slots.length>e;e++){var i=template_data.slots[e],a=selectHandler[i.id_prefix].getRole(),n=selectHandler[i.id_prefix].getQl();if("major"==i.group){var r=selectHandler[i.id_prefix].getSignet();if("none"!=r){var s=signet_data.find(i.group,r);t[s.stat]+=selectHandler[i.id_prefix].determineSignetQualityValue(s)}}"dps"==a?t["attack-rating"]+=custom_gear_data[template_data.slots[e].group].heal_dps["ql"+n].rating:"healer"==a?t["heal-rating"]+=custom_gear_data[template_data.slots[e].group].heal_dps["ql"+n].rating:"tank"==a?t.hitpoints+=custom_gear_data[template_data.slots[e].group].tank["ql"+n].hitpoints:a===void 0&&template_data.slots[e].is_weapon&&(t["weapon-power"]=custom_gear_data[template_data.slots[e].group][n].weapon_power)}return t["combat-power"]=this.calculateCombatPower(t["attack-rating"],t["weapon-power"]),t},this.calculateCombatPower=function(t,e){return Math.round((375-600/(Math.pow(Math.E,t/1400)+1))*(1+e/375))},this.updateOffensiveDefensiveStats=function(){var t=this.collectOffensiveDefensiveStats();this.updateGlyphValues(),this.updateStats(t),this.updateCosts()},this.collectOffensiveDefensiveStats=function(){for(var t={"critical-rating":0,"critical-chance":0,"critical-power":0,"critical-power-percentage":0,"penetration-rating":0,"hit-rating":0,"block-rating":0,"defense-rating":0,"evade-rating":0,"physical-protection":249,"magical-protection":249},e=0;template_data.slots.length>e;e++){var i=template_data.slots[e],a=selectHandler[i.id_prefix].getGlyphQl(),n=selectHandler[i.id_prefix].getGlyph("primary"),r=selectHandler[i.id_prefix].getGlyph("secondary"),s=buttonHandler[i.id_prefix].getActiveDist("primary").innerHTML,l=buttonHandler[i.id_prefix].getActiveDist("secondary").innerHTML;t[n]+=this.getGlyphValue(n,a,i.group,s),t[r]+=this.getGlyphValue(r,a,i.group,l)}return t["critical-chance"]=this.calculateCriticalChance(t["critical-rating"]),t["critical-power-percentage"]=this.calculateCriticalPowerPercentage(t["critical-power"]),t},this.getGlyphValue=function(t,e,i,a){return"none"==t||null==a?0:glyph_data.stat[t].ql[e].slot[i].dist[a]},this.updateGlyphValues=function(){for(var t=0;template_data.slots.length>t;t++){var e=template_data.slots[t],i=selectHandler[e.id_prefix].getGlyphQl(),a=selectHandler[e.id_prefix].getGlyph("primary"),n=selectHandler[e.id_prefix].getGlyph("secondary"),r=buttonHandler[e.id_prefix].getActiveDist("primary").innerHTML,s=buttonHandler[e.id_prefix].getActiveDist("secondary").innerHTML,l=this.getGlyphValue(a,i,e.group,r),o=this.getGlyphValue(n,i,e.group,s);this.updateGlyphValue(e.id_prefix,a,"primary",l),this.updateGlyphValue(e.id_prefix,n,"secondary",o)}},this.updateGlyphValue=function(t,e,i,a){"none"!=e&&"none"!=i&&0!=a?$("#"+t+"-"+i+"-glyph-value").html("+"+a):$("#"+t+"-"+i+"-glyph-value").html("0")},this.calculateCriticalChance=function(t){return 39-(68/(Math.pow(Math.E,t/787.6)+1)).toFixed(2)},this.calculateCriticalPowerPercentage=function(t){return Math.sqrt(5*t+625).toFixed(2)},this.updateStats=function(t){for(var e in t)t.hasOwnProperty(e)&&(t[e]>0?"critical-power-percentage"==e||"critical-chance"==e?$("#stat-"+e).html((""+t[e]).substring(0,4)+" %"):$("#stat-"+e).html("+"+t[e]):"critical-power-percentage"==e||"critical-chance"==e?$("#stat-"+e).html("0 %"):$("#stat-"+e).html("0"))}}function SelectHandler(t){var t=t,e=this;this.initiate=function(){e.addSignetsToSelect(),e.addListenersToSignetPickSelect(),e.addListenersToSignetQualitySelect(),e.addListenersToRoleSelect(),e.addListenersToQlSelect(),e.addListenersToGlyphSelect("glyph-ql"),e.addListenersToGlyphSelect("primary-glyph"),e.addListenersToGlyphSelect("secondary-glyph")},this.getRole=function(){return $("#"+t.id_prefix+"-role option:selected").attr("value")},this.getQl=function(){return $("#"+t.id_prefix+"-ql option:selected").attr("value")},this.getGlyphQl=function(){return $("#"+t.id_prefix+"-glyph-ql option:selected").attr("value")},this.getGlyph=function(e){return $("#"+t.id_prefix+"-"+e+"-glyph option:selected").attr("value")},this.getSignetQuality=function(){return $("#"+t.id_prefix+"-signet-quality option:selected").attr("value")},this.getSignet=function(){return $("#"+t.id_prefix+"-pick-signet option:selected").attr("value")},this.addSignetsToSelect=function(){var e=t.group;$("#"+t.id_prefix+"-pick-signet").append($("<option>",{value:"none",text:"None",selected:"true"})),"head"==t.group&&(e="weapon",$.each(signet_data[e],function(e,i){$("#"+t.id_prefix+"-pick-signet").append($("<option>",{value:i.id,text:i.name}))}));var i="assets/images/icons/"+t.group+"_dps.png",a="assets/images/icons/normal.png";$("#"+t.id_prefix+"-signet-img-icon").attr("src",i),$("#"+t.id_prefix+"-signet-img-quality").attr("src",a),$.each(signet_data[t.group],function(e,i){$("#"+t.id_prefix+"-pick-signet").append($("<option>",{value:i.id,text:i.name}))})},this.addListenersToSignetQualitySelect=function(){$("#"+t.id_prefix+"-signet-quality").change(function(){e.updateSignetIcon(),e.updateSignetDescription(),summary.updatePrimaryStats()})},this.addListenersToSignetPickSelect=function(){$("#"+t.id_prefix+"-pick-signet").change(function(){e.updateSignetIcon(),e.updateSignetDescription(),summary.updatePrimaryStats()})},this.updateSignetIcon=function(){var i=signet_data.find(t.group,e.getSignet());if(null!=i){var a="assets/images/icons/"+i.icon+".png";$("#"+t.id_prefix+"-signet-img-icon").attr("src",a);var n=this.getSignetQuality();if("none"!=n){var r="assets/images/icons/"+n+".png";$("#"+t.id_prefix+"-signet-img-quality").attr("src",r)}}},this.updateSignetDescription=function(){var i=signet_data.find(t.group,e.getSignet());if(null!=i){"none"==this.getSignetQuality()&&$("#"+t.id_prefix+"-signet-quality").val("normal");var a=this.getSignetDescription(i);$("#"+t.id_prefix+"-signet-description").html(a)}else $("#"+t.id_prefix+"-signet-description").html("")},this.getSignetDescription=function(t){if(null==t)return"";var i="";return i=t.description.replace("%s",e.determineSignetQualityValue(t)),i=i.replace("%d",e.determineSignetQualityValue(t)),"[object Array]"===Object.prototype.toString.call(t.quality)&&(i=i.replace("%0",e.determineSignetQualityValue(t,0)),i=i.replace("%1",e.determineSignetQualityValue(t,1))),i},this.determineSignetQualityValue=function(t,e){e=e!==void 0?e:-1;var i=this.getSignetQuality();return"normal"==i?-1!=e?t.quality[e].normal:t.quality.normal:"elite"==i?-1!=e?t.quality[e].elite:t.quality.elite:"epic"==i?-1!=e?t.quality[e].epic:t.quality.epic:0},this.addListenersToRoleSelect=function(){$("#"+t.id_prefix+"-role").change(function(){summary.updatePrimaryStats()})},this.addListenersToQlSelect=function(){$("#"+t.id_prefix+"-ql").change(function(){summary.updatePrimaryStats()})},this.addListenersToGlyphSelect=function(e){$("#"+t.id_prefix+"-"+e).change(function(){summary.updateOffensiveDefensiveStats()})}}function DistributionButtonHandler(t){var t=t,e=this;this.initiate=function(){this.addListenersToGlyphDistButtons("primary"),this.addListenersToGlyphDistButtons("secondary")},this.addListenersToGlyphDistButtons=function(i){this.onlyActiveButton("#"+t+"-"+i+"-glyph-dist-btn0"),$("#"+t+"-"+i+"-glyph-dist > button.btn").on("click",function(){e.onlyActiveButton("#"+this.id),e.balanceGlyphDist(this,i),summary.updateOffensiveDefensiveStats()})},this.balanceGlyphDist=function(t,i){otherActiveButton=e.getActiveDist(e.getInverseGlyphStat(i)),this.balanceGlyphDistOverflow(t,otherActiveButton)},this.getActiveDist=function(e){return $("#"+t+"-"+e+"-glyph-dist > button.btn.active")[0]},this.balanceGlyphDistOverflow=function(t,i){if(null!=i){var a=parseInt(t.innerHTML),n=parseInt(i.innerHTML),r=a+n;if(r>4){var s=i.id.substring(0,i.id.length-1)+(n-(r-4));e.onlyActiveButton("#"+s)}}},this.onlyActiveButton=function(t){$(t).siblings().removeClass("active"),$(t).siblings().removeClass("btn-success"),$(t).addClass("active"),$(t).addClass("btn-success")},this.getInverseGlyphStat=function(t){return"primary"==t?"secondary":"primary"}}function ButtonBar(){var t=this;this.initiate=function(){t.resetButton(),t.addAllRoleListenerToButton("dps"),t.addAllRoleListenerToButton("healer"),t.addAllRoleListenerToButton("tank"),t.addAllQlListenerToButton("10.4"),t.addAllQlListenerToButton("10.5")},this.addAllRoleListenerToButton=function(e){$("#btn-all-"+e).on("click",function(){for(var i=0;template_data.slots.length>i;i++)t.setRoleOnSlot(e,template_data.slots[i].id_prefix);summary.updateAllStats()})},this.setRoleOnSlot=function(t,e){$("#"+e+"-role").val(t)},this.addAllQlListenerToButton=function(e){qlid=e.replace(".","-"),$("#btn-all-"+qlid).on("click",function(){for(var i=0;template_data.slots.length>i;i++)t.setQlOnSlot(e,template_data.slots[i].id_prefix),t.setGlyphQlOnSlot(e,template_data.slots[i].id_prefix);summary.updateAllStats()})},this.setQlOnSlot=function(t,e){$("#"+e+"-ql").val(t)},this.setGlyphQlOnSlot=function(t,e){$("#"+e+"-glyph-ql").val(t),$("#"+e+"-primary-glyph-dist-btn4").trigger("click")},this.resetButton=function(){$("#btn-reset").on("click",function(){for(var e=0;template_data.slots.length>e;e++)t.resetAllInput(template_data.slots[e].id_prefix);summary.updateAllStats()})},this.resetAllInput=function(t){$("#"+t+"-ql").val("10.0"),$("#"+t+"-role").val("none"),$("#"+t+"-glyph-ql").val("10.0"),$("#"+t+"-primary-glyph").val("none"),$("#"+t+"-secondary-glyph").val("none"),$("#"+t+"-primary-glyph-dist-btn0").trigger("click"),$("#"+t+"-secondary-glyph-dist-btn0").trigger("click")}}function Export(){var t=this;this.initiate=function(){this.slotState={},$("a.export").on("click",function(e){t.exportType=$(e.target).attr("data"),t.startExport()}),$("#open-export-modal").on("shown",function(){$("#export-textarea").focus()}),$("#export-textarea").focus(function(){$(this).select(),$(this).mouseup(function(){return $(this).unbind("mouseup"),!1})})},this.startExport=function(){"url"==this.exportType?this.startExportUrl():"bbcode"==this.exportType&&this.startExportBBCode()},this.startExportUrl=function(){this.collectAllSlotStates(),url=this.createExportUrl(),$("#export-textarea").attr("rows","1"),$("#export-textarea").html(location.origin+location.pathname+"#"+url)},this.createExportUrl=function(){for(var t="",e=0;template_data.slots.length>e;e++)t+=this.createSlotUrl(template_data.slots[e].id_prefix),template_data.slots.length-1>e&&(t+="&");return t},this.createSlotUrl=function(t){var e=this.slotState[t];return t+"="+e.ql+","+e.role+","+e.glyph_ql+","+e.primary_glyph+","+e.secondary_glyph+","+e.primary_dist+","+e.secondary_dist+","+e.signet_quality+","+e.signet_id},this.startExportBBCode=function(){this.collectAllSlotStates(),dust.render("export\bbcode",{slotState:this.dustSlotState(),summary:summary.collectAllStats()},function(t,e){t&&console.log(t),$("#export-textarea").attr("rows","10"),$("#export-textarea").html(e)})},this.dustSlotState=function(){for(var t=[],e=0;template_data.slots.length>e;e++){var i=template_data.slots[e].id_prefix,a=template_data.slots[e].group,n=this.slotState[i],r=role_mapping.to_stat[n.role],s=0;0!=n.primary_glyph&&(s=glyph_data.stat[stat_mapping.to_stat[n.primary_glyph]].ql["10."+n.glyph_ql].slot[a].dist[n.primary_dist]);var l=0;0!=n.secondary_glyph&&(l=glyph_data.stat[stat_mapping.to_stat[n.secondary_glyph]].ql["10."+n.glyph_ql].slot[a].dist[n.secondary_dist]);var o=0,c=0;"healer"==r?(o="Heal Rating",c=custom_gear_data[a].heal_dps["ql10."+n.ql].rating):"dps"==r?(o="Attack Rating",c=custom_gear_data[a].heal_dps["ql10."+n.ql].rating):"tank"==r?(o="Hitpoints",c=custom_gear_data[a].tank["ql10."+n.ql].hitpoints):template_data.slots[e].is_weapon&&(o="Weapon Power",c=custom_gear_data[a]["10."+n.ql].weapon_power);var d=signet_data.find(a,n.signet_id);console.log(d);var p={name:capitalise(i),role:this.blankIfNone(capitalise(r)),ql:n.ql,stat_type:o,stat_value:c,glyph_ql:n.glyph_ql,primary_glyph:this.blankIfNone(capitalise(stat_mapping.to_stat[n.primary_glyph])),primary_dist:n.primary_dist,primary_value:s,secondary_glyph:this.blankIfNone(capitalise(stat_mapping.to_stat[n.secondary_glyph])),secondary_dist:n.secondary_dist,secondary_value:l,signet_name:d.name,signet_quality:this.blankIfNone(capitalise(signet_quality_mapping.to_name[n.signet_quality])),signet_description:selectHandler[i].getSignetDescription(d),signet_colour:signet_quality_mapping.to_colour[signet_quality_mapping.to_name[n.signet_quality]]};t.push(p)}return t},this.blankIfNone=function(t){return"None"==t?"":t},this.blankIfZero=function(t){for(var e in t.primary)t.primary.hasOwnProperty(e)&&t.primary[e]&&(t.primary[e]="")},this.collectAllSlotStates=function(){for(var t=0;template_data.slots.length>t;t++)this.collectSlotState(template_data.slots[t].id_prefix)},this.collectSlotState=function(e){this.slotState[e]={ql:t.stripContent($("#"+e+"-ql").val()),role:t.stripContent($("#"+e+"-role").val()),glyph_ql:t.stripContent($("#"+e+"-glyph-ql").val()),primary_glyph:t.stripContent($("#"+e+"-primary-glyph").val()),secondary_glyph:t.stripContent($("#"+e+"-secondary-glyph").val()),primary_dist:buttonHandler[e].getActiveDist("primary").innerHTML,secondary_dist:buttonHandler[e].getActiveDist("secondary").innerHTML,signet_quality:t.stripContent(selectHandler[e].getSignetQuality()),signet_id:t.stripContent(selectHandler[e].getSignet())}},this.stripContent=function(t){(null==t||"none"==t)&&(t=0);var e=/\d+\.\d/;return 0!=t&&t.match(e)?t.split(".")[1]:-1!=$.inArray(t,Object.keys(stat_mapping.to_num))?stat_mapping.to_num[t]:-1!=$.inArray(t,Object.keys(role_mapping.to_num))?role_mapping.to_num[t]:-1!=$.inArray(t,Object.keys(signet_quality_mapping.to_num))?signet_quality_mapping.to_num[t]:t}}function Import(){this.start=function(t){for(var e in t)t.hasOwnProperty(e)&&(splitVars=t[e].split(","),this.setValues(e,splitVars));summary.updateAllStats()},this.setValues=function(t,e){$("#"+t+"-ql").val("10."+e[0]),$("#"+t+"-role").val(role_mapping.to_stat[e[1]]),$("#"+t+"-glyph-ql").val("10."+e[2]),$("#"+t+"-primary-glyph").val(stat_mapping.to_stat[e[3]]),$("#"+t+"-secondary-glyph").val(stat_mapping.to_stat[e[4]]),$("#"+t+"-primary-glyph-dist-btn"+e[5]).trigger("click"),$("#"+t+"-secondary-glyph-dist-btn"+e[6]).trigger("click"),e[7]!==void 0&&e[8]!==void 0&&($("#"+t+"-signet-quality").val(signet_quality_mapping.to_name[e[7]]),$("#"+t+"-pick-signet").val(e[8]),$("#"+t+"-pick-signet").trigger("change"))}}(function(){function t(t){return t.write('<div class="btn-group"><button id="btn-reset" class="btn btn-danger">Reset</button></div><div class="btn-group"><button id="btn-all-dps" class="btn">All DPS</button><button id="btn-all-healer" class="btn">All Healer</button><button id="btn-all-tank" class="btn">All Tank</button></div><div class="btn-group"><button id="btn-all-10-4" class="btn">All 10.4</button><button id="btn-all-10-5" class="btn">All 10.5</button></div><div class="btn-group"><a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#">Export<span class="caret"></span></a><ul class="dropdown-menu"><li><a class="export" href="#open-export-modal" data="url" data-toggle="modal">URL</a></li><li><a class="export" href="#open-export-modal" data="bbcode" data-toggle="modal">BBCode</a></li></ul></div><div id="open-export-modal" class="modal hide fade"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h5>Export</h5></div><div class="modal-body">Copy this and share:<br/><textarea id="export-textarea" class="field span12" wrap="off" rows="10"></textarea></div></div>')}return dust.register("buttonbar",t),t})(),function(){function t(t,e){return t.write('<div class="masthead"><ul class="nav nav-pills pull-right"><li class="active"><a href="#">Calculator</a></li><li><a href="https://github.com/joakibj/tswcalc" target="_blank">Github</a></li></ul><h2 class="muted">tswcalc</h2></div><hr><div class="row-fluid"><div class="span12">').partial("buttonbar",e,null).write('</div></div><hr/><div class="row-fluid"><div class="span8">').partial("slots",e,null).write('</div><div class="span4">').partial("summary",e,null).write('</div></div><hr><div class="footer"><p>tswcalc &copy; 2013 Joakim Bj&oslash;rnstad. Hosted on Github Pages.</p></div>')}return dust.register("container",t),t}(),function(){function t(t,i){return t.write("[size=3]Configuration Output[/size]\n\n[size=2]Summary[/size]\n\n").section(i.get("summary"),i,{block:e},null).write("\n\n[size=2]Gear report[/size]\n\n[size=-1]").section(i.get("slotState"),i,{block:n},null).write("[/size]")}function e(t,e){return t.write("[size=-1]").section(e.get("primary"),e,{block:i},null).section(e.get("offensive_defensive"),e,{block:a},null).write("[/size]")}function i(t,e){return t.write("[b]Primary stats[/b]\n[indent]Hitpoints: [b]").reference(e.get("hitpoints"),e,"h").write("[/b][/indent]\n[indent]Combat Power: [b]").reference(e.get("combat-power"),e,"h").write("[/b][/indent]\n[indent]Attack Rating: [b]").reference(e.get("attack-rating"),e,"h").write("[/b][/indent]\n[indent]Weapon Power: [b]").reference(e.get("weapon-power"),e,"h").write("[/b][/indent]\n[indent]Heal Rating: [b]").reference(e.get("heal-rating"),e,"h").write("[/b][/indent]\n")}function a(t,e){return t.write("[b]Offensive stats[/b]\n[indent]Critical Rating: [b][color=green]").reference(e.get("critical-rating"),e,"h").write("[/color][/b][/indent]\n[indent]Critical Chance: [b][color=green]").reference(e.get("critical-chance"),e,"h").write(" %[/color][/b][/indent]\n[indent]Critical Power Rating: [b][color=green]").reference(e.get("critical-power"),e,"h").write("[/color][/b][/indent]\n[indent]Critical Power: [b][color=green]").reference(e.get("critical-power-percentage"),e,"h").write(" %[/color][/b][/indent]\n[indent]Penetration Rating: [b][color=green]").reference(e.get("penetration-rating"),e,"h").write("[/color][/b][/indent]\n[indent]Hit Rating: [b][color=green]").reference(e.get("hit-rating"),e,"h").write("[/color][/b][/indent]\n[b]Defensive stats[/b]\n[indent]Block Rating: [b][color=green]").reference(e.get("block-rating"),e,"h").write("[/color][/b][/indent]\n[indent]Defense Rating: [b][color=green]").reference(e.get("defense-rating"),e,"h").write("[/color][/b][/indent]\n[indent]Evade Rating: [b][color=green]").reference(e.get("evade-rating"),e,"h").write("[/color][/b][/indent]\n[indent]Physical Protection: [b][color=green]").reference(e.get("physical-protection"),e,"h").write("[/color][/b][/indent]\n[indent]Magical Protection: [b][color=green]").reference(e.get("magical-protection"),e,"h").write("[/color][/b][/indent]\n")}function n(t,e){return t.write("[b]").reference(e.get("name"),e,"h").write(" (QL [color=purple]10.").reference(e.get("ql"),e,"h").write("[/color]").exists(e.get("role"),e,{block:r},null).write(")[/b] ").exists(e.get("stat_type"),e,{block:s},null).write("\n[indent]Glyph (QL [color=purple]10.").reference(e.get("glyph_ql"),e,"h").write("[/color]): ").exists(e.get("primary_glyph"),e,{block:l},null).exists(e.get("secondary_glyph"),e,{block:o},null).write("[/indent]\n").exists(e.get("signet_name"),e,{block:c},null)}function r(t,e){return t.write(" ").reference(e.get("role"),e,"h")}function s(t,e){return t.write("[b][color=green]+").reference(e.get("stat_value"),e,"h").write("[/color][/b] ").reference(e.get("stat_type"),e,"h")}function l(t,e){return t.reference(e.get("primary_glyph"),e,"h").write(" [b][color=green]+").reference(e.get("primary_value"),e,"h").write("[/color][/b] (").reference(e.get("primary_dist"),e,"h").write("/4)")}function o(t,e){return t.write(" , ").reference(e.get("secondary_glyph"),e,"h").write(" [b][color=green]+").reference(e.get("secondary_value"),e,"h").write("[/color][/b] (").reference(e.get("secondary_dist"),e,"h").write("/4)")}function c(t,e){return t.write("[indent]Signet ([color=").reference(e.get("signet_colour"),e,"h").write("]").reference(e.get("signet_quality"),e,"h").write("[/color]): Signet of [b]").reference(e.get("signet_name"),e,"h").write("[/b]. ").reference(e.get("signet_description"),e,"h").write("[/indent]\n")}return dust.register("export\bbcode",t),t}(),function(){function t(t,e){return t.write('<div id="').reference(e.get("id_prefix"),e,"h").reference(e.get("id_suffix"),e,"h").write('-dist" class="btn-group glyphbuttons"><button id="').reference(e.get("id_prefix"),e,"h").reference(e.get("id_suffix"),e,"h").write('-dist-btn0" class="btn btn-mini btn-danger">0</button><button id="').reference(e.get("id_prefix"),e,"h").reference(e.get("id_suffix"),e,"h").write('-dist-btn1" class="btn btn-mini btn-danger">1</button><button id="').reference(e.get("id_prefix"),e,"h").reference(e.get("id_suffix"),e,"h").write('-dist-btn2" class="btn btn-mini btn-danger">2</button><button id="').reference(e.get("id_prefix"),e,"h").reference(e.get("id_suffix"),e,"h").write('-dist-btn3" class="btn btn-mini btn-danger">3</button><button id="').reference(e.get("id_prefix"),e,"h").reference(e.get("id_suffix"),e,"h").write('-dist-btn4" class="btn btn-mini btn-danger">4</button></div>')}return dust.register("glyphbuttons",t),t}(),function(){function t(t,e){return t.write('<select id="').reference(e.get("id_prefix"),e,"h").reference(e.get("id_suffix"),e,"h").write('-ql" class="select-ql"><option value="10.0">10.0</option><option value="10.1">10.1</option><option value="10.2">10.2</option><option value="10.3">10.3</option><option value="10.4">10.4</option><option value="10.5">10.5</option></select>')}return dust.register("qlselect",t),t}(),function(){function t(t,a){return t.section(a.get("slots"),a,{"else":e,block:i},null)}function e(t){return t.write("<p>No slots found (Bug)!</p>")}function i(t,e){return t.write('<div id="').reference(e.get("id_prefix"),e,"h").write('-slot" class="slot"><h4 class="slot">').reference(e.get("name"),e,"h").write('</h4> <table class="table table-slots"><tr>').notexists(e.get("is_weapon"),e,{block:a},null).write("<td><strong>QL:</strong></td><td>").partial("qlselect",e,{id_suffix:""}).write('</td><td class="filler"></td></tr></table><div><table id="').reference(e.get("id_prefix"),e,"h").write('-glyphs" class="table table-glyphs"><tr><td class="glyph-ql" rowspan="2"><a href="#" class="glyph-tooltip" data-toggle="tooltip" title="Glyph for the ').reference(e.get("name"),e,"h").write(' slot. Choose which QL and stats it will have in your build."><img src="assets/images/icons/glyph.png" alt="Glyph"/></a> ').partial("qlselect",e,{id_suffix:"-glyph"}).write("</td><td><strong>Primary Stat</strong></td><td>").partial("statselect",e,{id_suffix:"primary"}).write("</td><td><strong>Distribution:</strong> ").partial("glyphbuttons",e,{id_suffix:"-primary-glyph"}).write('</td><td id="').reference(e.get("id_prefix"),e,"h").write('-primary-glyph-value" class="statvalue">0</td></tr><tr><td><strong>Secondary Stat</strong></td><td>').partial("statselect",e,{id_suffix:"secondary"}).write("</td><td><strong>Distribution:</strong> ").partial("glyphbuttons",e,{id_suffix:"-secondary-glyph"}).write('</td><td id="').reference(e.get("id_prefix"),e,"h").write('-secondary-glyph-value" class="statvalue">0</td></tr></table></div><div><table id="').reference(e.get("id_prefix"),e,"h").write('-signets" class="table table-signets"><tr><td><a href="#" class="signet-tooltip" data-toggle="tooltip" title="Signet for the ').reference(e.get("name"),e,"h").write(' slot. Choose the quality and type of signet."><img id="').reference(e.get("id_prefix"),e,"h").write('-signet-img-quality" class="signet-quality" src="assets/images/icons/green.png"/><img id="').reference(e.get("id_prefix"),e,"h").write('-signet-img-icon" class="signet" src="assets/images/icons/minor_dps.png"/></a></td><td><select id="').reference(e.get("id_prefix"),e,"h").write('-signet-quality"><option value="none">Quality</option><option value="normal">Normal</option><option value="elite">Elite</option><option value="epic">Epic</option></select></td><td><select id="').reference(e.get("id_prefix"),e,"h").write('-pick-signet"></select></td><td id="').reference(e.get("id_prefix"),e,"h").write('-signet-description" class="signet-description"></td></tr></table></div></div>  ')}function a(t,e){return t.write('<td class="inner-fill"><strong>Role: </strong></td><td><select id="').reference(e.get("id_prefix"),e,"h").write('-role" class="select-role"><option value="none" selected="true">None</option><option value="dps">DPS</option><option value="tank">Tank</option><option value="healer">Healer</option></select></td>')}return dust.register("slots",t),t}(),function(){function t(t,e){return t.write('<select id="').reference(e.get("id_prefix"),e,"h").write("-").reference(e.get("id_suffix"),e,"h").write('-glyph" class="select-glyph"><option value="none" selected="true">None</option><option value="critical-rating">Critical Rating</option><option value="critical-power">Critical Power</option><option value="penetration-rating">Penetration Rating</option><option value="hit-rating">Hit Rating</option><option value="block-rating">Block Rating</option><option value="defense-rating">Defense Rating</option><option value="evade-rating">Evade Rating</option><option value="physical-protection">Physical Protection</option><option value="magical-protection">Magical Protection</option></select>')}return dust.register("statselect",t),t}(),function(){function t(t){return t.write('        <div id="summary"><h4>Summary</h4><div id="table-primary"><div class="row-fluid"><span class="span4"><a href="#" class="cost-tooltip" data-toggle="tooltip" title="Black Bullions drop from nightmare dungeon bosses."><img src="assets/images/icons/black_bullion.png" alt="Black Bullion"/></a> <span id="bb-cost">0</span></span><span class="span4"><a href="#" class="cost-tooltip" data-toggle="tooltip" title="Criterion Upgrades drop from the Unutterable Lurker in the Manhattan Exclusion Zone. Use with a nightwatch weapon/talisman toolkit to create 10.5 gear."><img src="assets/images/icons/criterion_upgrade.png" alt="Criterion Upgrade"/></a> <span id="cu-cost">0</span></span><span class="span4"><a href="#" class="cost-tooltip" data-toggle="tooltip" title="Astral Fuses drop from the Unutterable Lurker in the Manhattan Exclusion Zone. Use with a nightwatch glyph toolkit to create 10.5 glyphs."><img src="assets/images/icons/astral_fuse.png" alt="Astral Fuse"/></a> <span id="af-cost">0</span></span></div><table class="table table-stats"><thead><th>Primary Stat</th><th>Value</th></thead><tbody><tr><td class="statname">Hitpoints</td><td id="stat-hitpoints" class="statvalue">1970</td></tr><tr><td class="statname">Combat Power</td><td id="stat-combat-power" class="statvalue">0</td></tr><tr><td class="statname">Attack Rating</td><td id="stat-attack-rating" class="statvalue">0</td></tr><tr><td class="statname">Weapon Power</td><td id="stat-weapon-power" class="statvalue">0</td></tr><tr><td class="statname">Heal Rating</td><td id="stat-heal-rating" class="statvalue">0</td></tr></tbody></table></div><div id="table-offensive"><table class="table table-stats"><thead><th>Offensive Stat</th><th>Value</th></thead><tbody><tr><td class="statname">Critical Rating</td><td id="stat-critical-rating" class="statvalue">0 %</td></tr><tr><td class="statname">Critical Chance %</td><td id="stat-critical-chance" class="statvalue">0</td></tr><tr><td class="statname">Critical Power Rating</td><td id="stat-critical-power" class="statvalue">0</td></tr><tr><td class="statname">Critical Power</td><td id="stat-critical-power-percentage" class="statvalue">0 %</td></tr><tr><td class="statname">Penetration Rating</td><td id="stat-penetration-rating" class="statvalue">0</td></tr><tr><td class="statname">Hit Rating</td><td id="stat-hit-rating" class="statvalue">0</td></tr></tbody></table></div><div id="table-defensive"><table class="table table-stats"><thead><th>Defensive Stat</th><th>Value</th></thead><tbody><tr><td class="statname">Block Rating</td><td id="stat-block-rating" class="statvalue">0</td></tr><tr><td class="statname">Defense Rating</td><td id="stat-defense-rating" class="statvalue">0</td></tr><tr><td class="statname">Evade Rating</td><td id="stat-evade-rating" class="statvalue">0</td></tr><tr><td class="statname">Physical Protection</td><td id="stat-physical-protection" class="statvalue">249</td></tr><tr><td class="statname">Magical Protection</td><td id="stat-magical-protection" class="statvalue">249</td></tr></tbody></table></div></div>')}return dust.register("summary",t),t}();var buttonHandler={},selectHandler={},buttonBar=0,summary=0,exportModule=0,importModule=0;$(document).ready(function(){renderContainer(template_data),addHash(),activateToolTips(),startSubModules(),checkIfExported()||triggerReset(),$("#summary").scrollToFixed()});